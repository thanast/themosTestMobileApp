var app = {

		showAlert: function (message, title) {
		    if (navigator.notification) {
		        navigator.notification.alert(message, null, title, 'OK');
		    } else {
		        alert(title ? (title + ": " + message) : message);
		    }
		},
		
		
		 registerEvents: function() {
        $(window).on('hashchange', $.proxy(this.route, this));
        $(window).on('hashchange', $.proxy(this.route, this));
        $('body').on('mousedown', 'a', function(event) {
            $(event.target).addClass('tappable-active');
        });
        $('body').on('mouseup', 'a', function(event) {
            $(event.target).removeClass('tappable-active');
        });
    },

    route: function() {
        var hash = window.location.hash;
        if (!hash) {
        	var aHomeView = new HomeView(this.store);
            $('body').html(aHomeView.render().el);
            aHomeView.findByName();
            return;
        }
        var match = hash.match(app.detailsURL);
        if (match) {
            this.store.findById(Number(match[1]), function(employee) {
                $('body').html(new EmployeeView(employee).render().el);
            });
        }
    },

    initialize: function() {
    		var self = this;
    		this.detailsURL = /^#employees\/(\d{1,})/;
    		this.registerEvents();
        this.store = new MemoryStore(function() {
            self.route();
        });  
        
        
        cordova.plugins.barcodeScanner.scan(
		      function (result) {
		          alert("We got a barcode\n" +
		                "Result: " + result.text + "\n" +
		                "Format: " + result.format + "\n" +
		                "Cancelled: " + result.cancelled);
		      },
		      function (error) {
		          alert("Scanning failed: " + error);
		      },
		      {
		          preferFrontCamera : true, // iOS and Android
		          showFlipCameraButton : true, // iOS and Android
		          showTorchButton : true, // iOS and Android
		          torchOn: true, // Android, launch with the torch switched on (if available)
		          saveHistory: true, // Android, save scan history (default false)
		          prompt : "Place a barcode inside the scan area", // Android
		          resultDisplayDuration: 500, // Android, display scanned text for X ms. 0 suppresses it entirely, default 1500
		          formats : "QR_CODE,PDF_417", // default: all but PDF_417 and RSS_EXPANDED
		          orientation : "landscape", // Android only (portrait|landscape), default unset so it rotates with the device
		          disableAnimations : true, // iOS
		          disableSuccessBeep: false, // iOS and Android
		          continuousMode: false // Android
		      }
		   );
        
                                   
    }

};

app.initialize();